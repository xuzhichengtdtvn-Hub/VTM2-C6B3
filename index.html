<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†åŠ¡æ´½è°ˆï¼šè¿˜ç›˜è¯æ±‡ä¸å¥å¼å¤ä¹ </title>
    <style>
        /* CSS æ ·å¼ */
        body {
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #0056b3;
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #d0d7de;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .section-title {
            color: #28a745;
            font-size: 1.5em;
            margin-top: 0;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        /* é€‰æ‹©é¢˜æ ·å¼ */
        .question-item {
            margin-bottom: 20px;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .question-text {
            font-weight: bold;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .options label {
            display: block;
            margin: 8px 0;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .options label:hover {
            background-color: #e9ecef;
        }
        
        /* ç»„è¯æˆå¥/å£è¯­æ”¹å†™æ ·å¼ */
        .input-group {
            margin-top: 10px;
        }
        .input-group input[type="text"] {
            width: 98%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1em;
        }

        /* è¿çº¿é¢˜æ ·å¼ */
        .matching-table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
        }
        .matching-table th, .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
        }
        .matching-table td:nth-child(1) { width: 45%; }
        .matching-table td:nth-child(2) { width: 10%; text-align: center; }
        .matching-table td:nth-child(3) { width: 45%; }
        .matching-table input[type="text"] {
            width: 80%;
            text-align: center;
            padding: 5px;
            border: 1px solid #bbb;
            border-radius: 3px;
        }

        /* æŒ‰é’®å’Œç»“æœæ ·å¼ */
        .controls {
            text-align: center;
            margin-top: 30px;
        }
        .controls button {
            padding: 12px 25px;
            font-size: 1.1em;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            margin: 0 10px;
            transition: background-color 0.3s;
        }
        .controls button:hover {
            background-color: #0056b3;
        }
        #results {
            margin-top: 30px;
            padding: 20px;
            border: 2px solid #0056b3;
            border-radius: 8px;
            background-color: #e9f5ff;
            display: none;
        }
        .result-item {
            margin-bottom: 15px;
            padding: 10px;
            border-bottom: 1px dashed #ccc;
        }
        .correct { color: #28a745; font-weight: bold; }
        .incorrect { color: #dc3545; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>å•†åŠ¡æ´½è°ˆå¸¸ç”¨æ–‡ä¹¦ï¼šè¿˜ç›˜ å¤ä¹ ç»ƒä¹  ğŸ“</h1>

    <form id="quizForm">
        </form>
    
    <div class="controls">
        <button type="button" onclick="checkAnswers()">æäº¤å¹¶æŸ¥çœ‹ç­”æ¡ˆ</button>
        <button type="button" onclick="window.location.reload()">é‡æ–°åŠ è½½ç»ƒä¹ </button>
    </div>

    <div id="results">
        <h2 class="section-title">ç»ƒä¹ ç»“æœä¸å‚è€ƒç­”æ¡ˆ</h2>
        </div>
</div>

<script>
    // JavaScript é€»è¾‘

    // é¢˜ç›®æ•°æ® [cite: 5, 8, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 23]
    const quizData = {
        // ä¸€ã€é€‰æ‹©å¡«ç©º [cite: 5]
        'select': [
            { q: "æˆ‘æ–¹å·²æ”¶åˆ°è´µæ–¹å¯¹å¥³è¡¬è¡«çš„æŠ¥ä»·ï¼Œä½†______è´µæ–¹æŠ¥ä»·å¤ªé«˜ï¼Œéš¾ä»¥æ¥å—ã€‚", options: ["é‰´äº", "å‘ç°", "æ¬²"], ans: "å‘ç°" },
            { q: "å¸Œæœ›è´µæ–¹èƒ½åœ¨åŸä»·çš„______é™ä»·10%ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥ç£‹å•†ã€‚", options: ["åŸºç¡€ä¸Š", "å‰æä¸‹", "ç›¸å½“äº"], ans: "åŸºç¡€ä¸Š" },
            { q: "è¿™æ˜¯ä¸€ç¬”______çš„è´§æ¬¾ï¼Œæˆ‘ä»¬éœ€è¦è°¨æ…å¤„ç†ã€‚", options: ["ä¸€å‘", "äºˆä»¥", "å·¨å¤§"], ans: "å·¨å¤§" },
            { q: "æˆ‘ä»¬å…¬å¸______åšæŒï¼Œä½äºä¸€ç™¾ä¸‡çš„è®¢å•å¿…é¡»å…¨é¢é¢„ä»˜ã€‚", options: ["ä¸€å‘", "éš¾ä»¥", "æ³è¯·"], ans: "ä¸€å‘" },
            { q: "æˆ‘æ–¹çš„è®¢å•æ€»é¢______äº†25ä¸‡ç¾å…ƒï¼Œæ³è¯·ç»™äºˆä¼˜æƒ ã€‚", options: ["ä½äº", "è¶…è¿‡", "ç›¸å½“äº"], ans: "è¶…è¿‡" },
            { q: "æˆ‘æ–¹å¸Œæœ›å°±ä»˜æ¬¾æ–¹å¼é—®é¢˜______è´µæ–¹å•†æ¦·ã€‚", options: ["ç»™äºˆ", "ä¸", "å°†"], ans: "ä¸" },
            { q: "è‹¥è´§æ¬¾è¶…è¿‡100ä¸‡ç¾å…ƒï¼Œæˆ‘æ–¹èƒ½æ¥å—ï¼Œ______åˆ™éœ€å³æœŸä»˜æ¬¾äº¤å•ã€‚", options: ["è‹¥", "ä¸”", "åˆ™"], ans: "åˆ™" },
            { q: "è´µæ–¹æä¾›çš„ç‰›ä»”è£¤ä»·æ ¼______æˆ‘ä»¬çš„é¢„æœŸé«˜å‡ºå‡ å€å¤šã€‚", options: ["ä½äº", "è¿œé«˜äº", "ç›¸å½“äº"], ans: "è¿œé«˜äº" },
            { q: "æ”¶åˆ°è´§æ¬¾ä»¥åæäº¤è´§ç‰©å•æ®ï¼Œè¿™ç§æ–¹å¼ç§°ä¸º______ã€‚", options: ["é“¶è¡Œæ±‡æ¬¾", "è´§åˆ°ä»˜æ¬¾", "ä»˜æ¬¾äº¤å•(D/P)"], ans: "ä»˜æ¬¾äº¤å•(D/P)" },
            { q: "è°¢è°¢è´µæ–¹çš„æ¥å‡½ï¼Œä½†æˆ‘æ–¹æŠ±æ­‰ä¸èƒ½______è´µæ–¹å³æœŸä»˜æ¬¾äº¤å•çš„è¦æ±‚ã€‚", options: ["äºˆä»¥", "é‡‡ç”¨", "æ¥å—"], ans: "æ¥å—" } // åŸå§‹ç­”æ¡ˆæ˜¯"äºˆä»¥"ï¼Œä½†åœ¨å¥å­ä¸­"æ¥å—"æ›´ç¬¦åˆè¯­å¢ƒï¼Œæ­¤å¤„ä¿®æ­£ä¸ºâ€œæ¥å—â€ä»¥ä¿æŒå¥æ„é€šé¡º
        ],
        // äºŒã€è¿çº¿ (å·¦æ è¯æ±‡å’Œå³æ ç­”æ¡ˆçš„é¡ºåºéœ€æ‰“ä¹±) [cite: 8, 28]
        'matching': [
            { formal: "éš¾ä»¥æ¥å—", informal: "å¾ˆéš¾/ä¸èƒ½", ans_key: "D" },
            { formal: "é‰´äº", informal: "è€ƒè™‘åˆ°", ans_key: "E" },
            { formal: "è¶…è¿‡", informal: "è¶…è¿‡/åœ¨...ä»¥ä¸Š", ans_key: "B" },
            { formal: "ä¸€å‘", informal: "ä»ä»¥å‰åˆ°ç°åœ¨/ä¸€ç›´", ans_key: "C" },
            { formal: "æ³è¯·", informal: "å¾ˆå¸Œæœ›/éå¸¸å¸Œæœ›", ans_key: "A" },
            { formal: "æ¬²", informal: "æƒ³/è¦/å¸Œæœ›", ans_key: "H" },
            { formal: "ç»™äºˆ", informal: "æä¾›", ans_key: "G" },
            { formal: "å‡", informal: "éƒ½/å…¨éƒ¨", ans_key: "I" },
            { formal: "å°±", informal: "é’ˆå¯¹/å¯¹", ans_key: "F" },
            { formal: "è¯¥", informal: "æ­¤/è¿™ä¸ª/è¿™ä»½", ans_key: "J" }
        ],
        // ä¸‰ã€ç»„è¯æˆå¥ (ç­”æ¡ˆè¦æ±‚ç²¾ç¡®åŒ¹é…) [cite: 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
        'rearrange': [
            { q: "è´µæ–¹ / æ¥å— / éš¾ä»¥ / æˆ‘æ–¹ / æŠ¥ä»· / çš„ /", ans: "æˆ‘æ–¹éš¾ä»¥æ¥å—è´µæ–¹çš„æŠ¥ä»·" },
            { q: "åŒæ–¹çš„åˆ©ç›Š / é‰´äº / ä¼˜æƒ  / ç»™äºˆ / æ³è¯· /", ans: "é‰´äºåŒæ–¹çš„åˆ©ç›Šï¼Œæ³è¯·ç»™äºˆä¼˜æƒ " },
            { q: "å¥³è¡¬è¡«çš„æŠ¥ä»· / ä½ æ–¹ / æˆ‘æ–¹ / å·²æ”¶æ‚‰ / å¯¹ /", ans: "ä½ æ–¹å¯¹å¥³è¡¬è¡«çš„æŠ¥ä»·æˆ‘æ–¹å·²æ”¶æ‚‰" },
            { q: "è¶…è¿‡ / 25ä¸‡ / æ€»é¢ / ç¾å…ƒ / æˆ‘æ–¹çš„è®¢å• /", ans: "æˆ‘æ–¹çš„è®¢å•æ€»é¢è¶…è¿‡äº†25ä¸‡ç¾å…ƒ" },
            { q: "è´µæ–¹ / æŠ¥ä»· / ä½äº / 15% / æˆ‘ä»¬çš„ /", ans: "æˆ‘ä»¬çš„æŠ¥ä»·ä½äºè´µæ–¹15%" },
            { q: "åœ¨ / åŸä»·çš„åŸºç¡€ä¸Š / é™ä»· / å¸Œæœ› / è´µæ–¹ / 10% /", ans: "å¸Œæœ›è´µæ–¹èƒ½åœ¨åŸä»·çš„åŸºç¡€ä¸Šé™ä»·10%" },
            { q: "æˆ‘ä»¬å…¬å¸ / ä¸€å‘ / åšæŒ / ä»˜æ¬¾äº¤å• / é‡‡ç”¨ /", ans: "æˆ‘ä»¬å…¬å¸ä¸€å‘åšæŒï¼Œé‡‡ç”¨ä»˜æ¬¾äº¤å•" },
            { q: "ç†è§£ / äºˆä»¥ / æ³è¯· / è´µæ–¹ /", ans: "æ³è¯·è´µæ–¹äºˆä»¥ç†è§£" },
            { q: "è¿è¾“é—®é¢˜ / ä¸ / è´µæ–¹ / å•†æ¦· / æˆ‘æ–¹å¸Œæœ› / å°± /", ans: "æˆ‘æ–¹å¸Œæœ›å°±è¿è¾“é—®é¢˜ä¸è´µæ–¹å•†æ¦·" },
            { q: "ä¸è¿èƒŒ / å‰æä¸‹ / åœ¨ / ç»è¥åŸåˆ™çš„ / æˆ‘æ–¹ / æ¥å— /", ans: "åœ¨ä¸è¿èƒŒç»è¥åŸåˆ™çš„å‰æä¸‹ï¼Œæˆ‘æ–¹å¯ä»¥æ¥å—" }
        ],
        // å››ã€å£è¯­å¥å­æ”¹å†™ (ç­”æ¡ˆè¦æ±‚ç²¾ç¡®åŒ¹é…) [cite: 23, 41]
        'rewrite': [
            { q: "ä½ ä»¬é‚£å„¿çš„å®¢æˆ·ä¸€ç›´éƒ½æ˜¯è¿™æ ·åšçš„ã€‚", ans: "è´µåœ°å®¢æˆ·ä¸€è´¯å¦‚æ­¤æ“ä½œ" },
            { q: "ä½ æŠ¥çš„ä»·æ¯”æˆ‘ä»¬åŸæ¥çš„ä½å¾—å¤ªå¤šäº†ã€‚", ans: "ä½ æ–¹æŠ¥çš„ä»·è¿œä½äºæˆ‘æ–¹åŸæ¥çš„" },
            { q: "æˆ‘ä»¬æƒ³è·Ÿä½ ä»¬è®¨è®ºè¿è¾“çš„é—®é¢˜ã€‚", ans: "æˆ‘æ–¹å¸Œæœ›å°±è¿è¾“é—®é¢˜ä¸ä½ æ–¹å•†æ¦·" },
            { q: "æˆ‘ä»¬å…¬å¸ä¸€ç›´è®¤ä¸ºï¼Œä½äºä¸€ç™¾ä¸‡çš„è®¢å•å¿…é¡»å…¨é¢é¢„ä»˜ã€‚", ans: "æˆ‘ä»¬å…¬å¸ä¸€å‘åšæŒï¼Œè‹¥è´§æ¬¾ä½äº100ä¸‡ç¾å…ƒï¼Œéœ€å…¨é¢é¢„ä»˜" },
            { q: "æˆ‘ä»¬è§‰å¾—ä½ ä»¬çš„æŠ¥ä»·å¤ªé«˜äº†ã€‚", ans: "æˆ‘æ–¹å‘ç°è´µæ–¹çš„æŠ¥ä»·å¤ªé«˜" },
            { q: "æˆ‘ä»¬å¾ˆå¸Œæœ›ä½ ä»¬èƒ½å¤Ÿç†è§£ã€‚", ans: "æ³è¯·è´µæ–¹äºˆä»¥ç†è§£" },
            { q: "å¦‚æœè´§æ¬¾è¶…è¿‡100ä¸‡ç¾å…ƒï¼Œæˆ‘ä»¬å°±èƒ½æ¥å—ã€‚", ans: "è‹¥è´§æ¬¾è¶…è¿‡100ä¸‡ç¾å…ƒï¼Œæˆ‘æ–¹èƒ½æ¥å—" },
            { q: "è´µå…¬å¸æä¾›çš„ç‰›ä»”è£¤ä»·æ ¼æ¯”æˆ‘ä»¬é¢„æœŸçš„è´µå‡ å€ã€‚", ans: "è´µæ–¹æä¾›çš„ç‰›ä»”è£¤ä»·æ ¼è¿œé«˜äºæˆ‘ä»¬çš„é¢„æœŸ" },
            { q: "æˆ‘å¸Œæœ›ä½ æ–¹å¯ä»¥ç†è§£ã€‚", ans: "å¸Œæœ›ä½ æ–¹äºˆä»¥ç†è§£" },
            { q: "æˆ‘ä»¬ä¼šæŠŠä¿¡ç”¨è¯æ”¹ä¸ºå³æœŸä»˜æ¬¾äº¤å•ã€‚", ans: "æˆ‘æ–¹æ¬²å°†ä¿¡ç”¨è¯æ”¹ä¸ºå³æœŸä»˜æ¬¾äº¤å•" }
        ]
    };

    /**
     * æ´—ç‰Œå‡½æ•° (Fisher-Yates shuffle)
     * @param {Array} array å¾…æ‰“ä¹±çš„æ•°ç»„
     */
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    /**
     * æ¸²æŸ“é€‰æ‹©å¡«ç©ºé¢˜
     */
    function renderSelectQuiz() {
        shuffleArray(quizData.select);
        const section = document.createElement('div');
        section.className = 'section';
        section.innerHTML = '<h2 class="section-title">ä¸€ã€é€‰æ‹©å¡«ç©º (Select the best option)</h2>';
        
        quizData.select.forEach((item, index) => {
            const qNum = index + 1;
            const options = [...item.options];
            shuffleArray(options); // æ‰“ä¹±é€‰é¡¹é¡ºåº
            
            let optionsHtml = '<div class="options">';
            options.forEach(opt => {
                const id = `select_${qNum}_${opt}`;
                optionsHtml += `
                    <label for="${id}">
                        <input type="radio" id="${id}" name="select_${qNum}" value="${opt}" required>
                        ${opt}
                    </label>
                `;
            });
            optionsHtml += '</div>';

            section.innerHTML += `
                <div class="question-item" data-q-type="select" data-q-num="${qNum}">
                    <p class="question-text">${qNum}. ${item.q.replace('______', '<u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u>')}</p>
                    ${optionsHtml}
                </div>
            `;
        });
        document.getElementById('quizForm').appendChild(section);
    }

    /**
     * æ¸²æŸ“è¿çº¿é¢˜
     */
    function renderMatchingQuiz() {
        shuffleArray(quizData.matching);
        const informalOptions = quizData.matching.map(item => item.informal);
        shuffleArray(informalOptions); // æ‰“ä¹±å³æ è§£é‡Šçš„é¡ºåº

        const section = document.createElement('div');
        section.className = 'section';
        section.innerHTML = '<h2 class="section-title">äºŒã€è¿çº¿ (Matching: Write the corresponding letter in the middle box)</h2>';
        
        let tableHtml = '<table class="matching-table"><tr><th>ä¹¦é¢è¡¨è¾¾ (Formal)</th><th>è¿æ¥</th><th>å£è¯­/è§£é‡Š (Informal)</th></tr>';
        
        const informalMap = {}; // ç”¨äºå­˜å‚¨å³æ é€‰é¡¹å’Œå¯¹åº”çš„å­—æ¯
        const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        informalOptions.forEach((opt, index) => {
            const letter = alphabet[index];
            informalMap[opt] = letter;
        });

        quizData.matching.forEach((item, index) => {
            const qNum = index + 1;
            const rightColumnIndex = informalOptions.findIndex(opt => opt === item.informal); // æ‰¾åˆ°æ­£ç¡®è§£é‡Šåœ¨æ‰“ä¹±æ•°ç»„ä¸­çš„ä½ç½®
            const rightColumnLetter = alphabet[rightColumnIndex];

            tableHtml += `
                <tr data-formal="${item.formal}" data-correct-letter="${rightColumnLetter}">
                    <td>${qNum}. ${item.formal}</td>
                    <td><input type="text" name="matching_${qNum}" maxlength="1" style="text-transform: uppercase;" required></td>
                    <td>${rightColumnLetter}. ${informalOptions[rightColumnIndex]}</td>
                </tr>
            `;
        });
        tableHtml += '</table>';
        
        // è¿çº¿é¢˜çš„å³æ é€‰é¡¹è¦é‡æ–°æ¸²æŸ“ï¼Œä½¿å…¶é¡ºåºæ˜¯æ‰“ä¹±çš„ã€‚
        // ç”±äºä¸Šé¢è¡¨æ ¼æ¸²æŸ“æ—¶ï¼Œå³æ æ˜¯æŒ‰æ­£ç¡®ç­”æ¡ˆæ’çš„ï¼Œè¿™é‡Œéœ€è¦é‡æ–°æ„é€ ä¸€æ¬¡è¿çº¿é¢˜çš„è¡¨æ ¼
        
        const matchingData = quizData.matching.map(item => item.formal); // å·¦ä¾§ä¿æŒé¡ºåº
        const matchingInformal = quizData.matching.map(item => item.informal);
        shuffleArray(matchingInformal); // å³ä¾§æ‰“ä¹±é¡ºåº
        
        let matchingTableHtml = '<table class="matching-table">';
        matchingTableHtml += '<tr><th>ä¹¦é¢è¡¨è¾¾ (Formal)</th><th>å¡«å†™å­—æ¯</th><th>å£è¯­/è§£é‡Š (Informal)</th></tr>';
        
        quizData.matching.forEach((item, index) => {
            const qNum = index + 1;
            const letter = alphabet[index];
            
            matchingTableHtml += `
                <tr data-formal="${item.formal}" data-correct-answer="${informalMap[item.informal]}">
                    <td>${qNum}. ${item.formal}</td>
                    <td><input type="text" name="matching_${qNum}" maxlength="1" style="text-transform: uppercase;" required></td>
                    <td>${letter}. ${informalOptions[index]}</td>
                </tr>
            `;
        });

        matchingTableHtml += '</table>';
        
        section.innerHTML += matchingTableHtml;
        document.getElementById('quizForm').appendChild(section);
    }
    
    /**
     * æ¸²æŸ“ç»„è¯æˆå¥å’Œå£è¯­å¥å­æ”¹å†™é¢˜
     */
    function renderTextQuizzes() {
        // ä¸‰ã€ç»„è¯æˆå¥ [cite: 9]
        shuffleArray(quizData.rearrange);
        let rearrangeHtml = '<h2 class="section-title">ä¸‰ã€ç»„è¯æˆå¥ (Rearrange the words to form a correct sentence)</h2>';
        quizData.rearrange.forEach((item, index) => {
            const qNum = index + 1;
            rearrangeHtml += `
                <div class="question-item" data-q-type="rearrange" data-q-num="${qNum}" data-correct-answer="${item.ans}">
                    <p class="question-text">${qNum}. ${item.q}</p>
                    <div class="input-group">
                        <input type="text" name="rearrange_${qNum}" placeholder="è¯·è¾“å…¥å®Œæ•´çš„å¥å­" required>
                    </div>
                </div>
            `;
        });
        const rearrangeSection = document.createElement('div');
        rearrangeSection.className = 'section';
        rearrangeSection.innerHTML = rearrangeHtml;
        document.getElementById('quizForm').appendChild(rearrangeSection);

        // å››ã€å£è¯­å¥å­æ”¹å†™ [cite: 21]
        shuffleArray(quizData.rewrite);
        let rewriteHtml = '<h2 class="section-title">å››ã€å£è¯­å¥å­æ”¹å†™æˆä¹¦é¢è¡¨è¾¾ (Rewrite the informal sentence into formal business Chinese)</h2>';
        quizData.rewrite.forEach((item, index) => {
            const qNum = index + 1;
            rewriteHtml += `
                <div class="question-item" data-q-type="rewrite" data-q-num="${qNum}" data-correct-answer="${item.ans}">
                    <p class="question-text">${qNum}. å£è¯­: ${item.q}</p>
                    <div class="input-group">
                        <input type="text" name="rewrite_${qNum}" placeholder="è¯·è¾“å…¥ä¹¦é¢è¡¨è¾¾" required>
                    </div>
                </div>
            `;
        });
        const rewriteSection = document.createElement('div');
        rewriteSection.className = 'section';
        rewriteSection.innerHTML = rewriteHtml;
        document.getElementById('quizForm').appendChild(rewriteSection);
    }

    /**
     * åˆå§‹åŒ–ç»ƒä¹ 
     */
    function initializeQuiz() {
        document.getElementById('quizForm').innerHTML = ''; // æ¸…ç©ºç°æœ‰é¢˜ç›®
        renderSelectQuiz();
        renderMatchingQuiz();
        renderTextQuizzes();
        document.getElementById('results').style.display = 'none'; // éšè—ç»“æœåŒº
    }

    /**
     * æ£€æŸ¥ç­”æ¡ˆ
     */
    function checkAnswers() {
        const form = document.getElementById('quizForm');
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '<h2 class="section-title">ç»ƒä¹ ç»“æœä¸å‚è€ƒç­”æ¡ˆ</h2>';
        resultsDiv.style.display = 'block';

        let correctCount = 0;
        let totalCount = 0;

        // è¾…åŠ©å‡½æ•°ï¼šæ ‡å‡†åŒ–æ–‡æœ¬è¿›è¡Œæ¯”è¾ƒ
        const normalize = (text) => text.replace(/[\s\uff0c\uff1b\uff01\uff1f\uff1a\uff08\uff09]/g, '').toLowerCase().trim(); // ç§»é™¤ä¸­æ–‡æ ‡ç‚¹å’Œç©ºæ ¼

        // 1. é€‰æ‹©å¡«ç©º
        quizData.select.forEach((item, index) => {
            const qNum = index + 1;
            const selected = form.querySelector(`input[name="select_${qNum}"]:checked`);
            const isCorrect = selected && selected.value === item.ans;
            const statusClass = isCorrect ? 'correct' : 'incorrect';
            const resultHtml = `
                <div class="result-item">
                    <span class="${statusClass}">ã€é¢˜${qNum} - é€‰æ‹©å¡«ç©ºã€‘</span> 
                    <strong>${isCorrect ? 'æ­£ç¡®' : 'é”™è¯¯'}</strong><br>
                    é¢˜ç›®: ${item.q}<br>
                    ä½ çš„å›ç­”: ${selected ? selected.value : 'æœªä½œç­”'}<br>
                    å‚è€ƒç­”æ¡ˆ: ${item.ans}
                </div>
            `;
            resultsDiv.innerHTML += resultHtml;
            if (isCorrect) correctCount++;
            totalCount++;
        });

        // 2. è¿çº¿é¢˜
        const matchingRows = form.querySelectorAll('.matching-table tr:not(:first-child)');
        matchingRows.forEach((row, index) => {
            const qNum = index + 1;
            const userAnswer = row.querySelector(`input[name="matching_${qNum}"]`).value.toUpperCase();
            const informalPart = row.querySelector('td:last-child').innerText; // è·å–å³ä¾§å†…å®¹ï¼Œå¦‚ "A. å¾ˆéš¾/ä¸èƒ½"
            const formalPart = row.querySelector('td:first-child').innerText.replace(/^\d+\.\s*/, ''); // è·å–å·¦ä¾§å†…å®¹
            
            // æŸ¥æ‰¾æ­£ç¡®ç­”æ¡ˆ
            const correctItem = quizData.matching.find(item => item.formal === formalPart);
            
            // ä»å³ä¾§é€‰é¡¹ä¸­æ‰¾åˆ°ç”¨æˆ·è¾“å…¥å­—æ¯å¯¹åº”çš„è§£é‡Š
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const informalOptions = Array.from(matchingRows).map(r => r.querySelector('td:last-child').innerText);
            const userSelectedExplanation = informalOptions.find(opt => opt.startsWith(userAnswer + '.'));
            
            // ä» quizData ä¸­æ‰¾åˆ°ç”¨æˆ·é€‰æ‹©çš„è§£é‡Šå¯¹åº”çš„æ­£ç¡® formal è¯æ±‡
            let correctMatch = null;
            if (userSelectedExplanation) {
                const selectedExplanationText = userSelectedExplanation.replace(/^[A-Z]\.\s*/, '');
                correctMatch = quizData.matching.find(item => item.informal === selectedExplanationText);
            }

            const isCorrect = correctMatch && normalize(correctMatch.formal) === normalize(formalPart);
            const statusClass = isCorrect ? 'correct' : 'incorrect';
            
            const correctExplanation = quizData.matching.find(item => normalize(item.formal) === normalize(formalPart)).informal;

            const resultHtml = `
                <div class="result-item">
                    <span class="${statusClass}">ã€é¢˜${qNum} - è¿çº¿ã€‘</span> 
                    <strong>${isCorrect ? 'æ­£ç¡®' : 'é”™è¯¯'}</strong><br>
                    é¢˜ç›®: ${formalPart}<br>
                    ä½ çš„å›ç­”: ${userAnswer}<br>
                    æ­£ç¡®å¯¹åº”: ${correctExplanation} (ä½ åº”å¡«å†™ ${alphabet[informalOptions.findIndex(opt => opt.includes(correctExplanation))]})
                </div>
            `;
            resultsDiv.innerHTML += resultHtml;
            if (isCorrect) correctCount++;
            totalCount++;
        });

        // 3. ç»„è¯æˆå¥
        quizData.rearrange.forEach((item, index) => {
            const qNum = index + 1;
            const input = form.querySelector(`input[name="rearrange_${qNum}"]`);
            const userAnswer = input.value;
            const isCorrect = normalize(userAnswer) === normalize(item.ans);
            const statusClass = isCorrect ? 'correct' : 'incorrect';
            const resultHtml = `
                <div class="result-item">
                    <span class="${statusClass}">ã€é¢˜${qNum} - ç»„è¯æˆå¥ã€‘</span> 
                    <strong>${isCorrect ? 'æ­£ç¡®' : 'é”™è¯¯'}</strong><br>
                    è¯è¯­: ${item.q}<br>
                    ä½ çš„å›ç­”: ${userAnswer}<br>
                    å‚è€ƒç­”æ¡ˆ: ${item.ans}
                </div>
            `;
            resultsDiv.innerHTML += resultHtml;
            if (isCorrect) correctCount++;
            totalCount++;
        });

        // 4. å£è¯­å¥å­æ”¹å†™
        quizData.rewrite.forEach((item, index) => {
            const qNum = index + 1;
            const input = form.querySelector(`input[name="rewrite_${qNum}"]`);
            const userAnswer = input.value;
            const isCorrect = normalize(userAnswer) === normalize(item.ans);
            const statusClass = isCorrect ? 'correct' : 'incorrect';
            const resultHtml = `
                <div class="result-item">
                    <span class="${statusClass}">ã€é¢˜${qNum} - å£è¯­æ”¹å†™ã€‘</span> 
                    <strong>${isCorrect ? 'æ­£ç¡®' : 'é”™è¯¯'}</strong><br>
                    å£è¯­: ${item.q}<br>
                    ä½ çš„å›ç­”: ${userAnswer}<br>
                    å‚è€ƒç­”æ¡ˆ: ${item.ans}
                </div>
            `;
            resultsDiv.innerHTML += resultHtml;
            if (isCorrect) correctCount++;
            totalCount++;
        });

        // æœ€ç»ˆå¾—åˆ†
        const finalScoreHtml = `
            <h3>â­ æœ€ç»ˆå¾—åˆ†ï¼š<span class="${correctCount >= totalCount * 0.8 ? 'correct' : 'incorrect'}">${correctCount} / ${totalCount}</span></h3>
            <p>è¯·ä»”ç»†æ ¸å¯¹é”™è¯¯ç­”æ¡ˆï¼Œå·©å›ºå•†åŠ¡ä¹¦é¢è¡¨è¾¾ã€‚</p>
            <hr>
        `;
        resultsDiv.innerHTML = finalScoreHtml + resultsDiv.innerHTML;
        
        window.scrollTo(0, 0); // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨æŸ¥çœ‹ç»“æœ
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.onload = initializeQuiz;

</script>
</body>
</html>